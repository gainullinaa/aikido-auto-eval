# Автоматическое распознавание ошибок в приемах айкидо
Дипломный преокт о применении глубокого машинного обучения для нахождения ошибок в видеозаписях спортсменов, выполняющих приемы айкидо. В проекте используется Python 3, PyTorch.  
Исследования проводятся на координатах ключевых точек человека на изображении, которые получены с использованием AlphaPose. Эти точки хранятся в json-файлах.  
Ключевые точки собираются в изображение-подобную структуру - трёхмерный тензор. Всего 26 ключевых точек/суставов (формат датасета Halpe, связанного с AlphaPose), у которых есть 2 координаты (oX, oY в плоскости кадра) и уверенность/вероятность ALphaPose модели в этой точке. Детектирование проводится по каждому кадру упражнения, пока его начало и конец берутся из ручной авторской разметки. Таким образом упражнение собирается в тензор (26, количество кадров упражнения, 3), где 26 - количество суставов, 3 - 2 координаты сустава + 1 его вероятность.
## Кодовые файлы проекта
- cnn_cls_training.ipynb - обучение multilabel классификатора на базе свёрточных слоев (пока опробована ResNet архитектура)
- lstm_cls_training.ipynb - обучение multilabel классификатора на базе рекуррентных слоев (LSTM)
- data_analysis.ipynb - код для получения предсказаний ключевых точек с AlphaPose, по которым проводится последующий анализ
- embeddings_analysis.ipynb - анализ эмбеддингов тензора упражнения
- dataproc.py - подготовка данных: трекинг отдельного ученика сквозь фреймы, парсинг json-файлах точек
- train_utils.py - функции для подготовки данных для обучения модели нейросети
- tracking_nn.ipynb - реидентификация людей с помощью автокодировщика и алгоритмов схожести SSIM и PSNR
- exercise_split.ipynb - исследование для автоматического разделения упражнений; неуспешно, поэтому блокнот не заполнен
## Файловое дерево проекта

```
 |_ папка проекта
 |_ AlphaPose
 |_ alphapose_res (аннотации ключевых точек, полученные с применением AlphaPose)
 |_ data (ручные аннотации ошибок и границ упражнений)
    |_ single_student_annotations.json
    |_ ushiro_tenkan_mae_tenkan
       |_ annotations.json
    |_ tsugi_ashi
       |_ annotations.json
    |_ irimi_tenkan
       |_ annotations.json

```
## Ссылки на источники
- [AlphaPose](https://github.com/MVIG-SJTU/AlphaPose) 
